<html>
<head>
    <title>Search</title>
        <input type="hidden" id="myVar" name="variable" value='{{ json }}'>
</head>
<body>
<script type="text/javascript" src="http://maps.googleapis.com/maps/api/js?sensor=false"></script>
<script type="text/javascript">
    //Array of JSON objects.
    var myVar = document.getElementById("myVar").value;
    var ee = JSON.parse(myVar);
{#    console.log(ee[0]);#}
    var markers = ee;
{#    var markers = [#}
{#    {#}
{#        title: 'Aksa Beach',#}
{#        lat: 19.1759668,#}
{#        lng: 72.79504659999998,#}
{#        description: 'Aksa Beach is a popular beach and a vacation spot in Aksa village at Malad, Mumbai.'#}
{#    },#}
{#    {#}
{#        "title": 'Juhu Beach',#}
{#        "lat": 19.0883595,#}
{#        "lng": 72.82652380000002,#}
{#        "description": 'Juhu Beach is one of favorite tourist attractions situated in Mumbai.'#}
{#    },#}
{#    {#}
{#        "title": 'Girgaum Beach',#}
{#        "lat": 18.9542149,#}
{#        "lng": 72.81203529999993,#}
{#        "description": 'Girgaum Beach commonly known as just Chaupati is one of the most famous public beaches in Mumbai.'#}
{#    },#}
{#    {#}
{#        "title": 'Jijamata Udyan',#}
{#        "lat": 18.979006,#}
{#        "lng": 72.83388300000001,#}
{#        "description": 'Jijamata Udyan is situated near Byculla station is famous as Mumbai (Bombay) Zoo.'#}
{#    },#}
{#    {#}
{#        "title": 'Sanjay Gandhi National Park',#}
{#        "lat": 19.2147067,#}
{#        "lng": 72.91062020000004,#}
{#        "description": 'Sanjay Gandhi National Park is a large protected area in the northern part of Mumbai city.'#}
{#    }#}
{#    ];#}
    window.onload = function () {
        LoadMap();
    }
{#    function setRoute(routeNumber){#}
{#         var mapOptions = {#}
{#            center: new google.maps.LatLng(markers[0].lat, markers[0].lng),#}
{#            zoom: 2,#}
{#            mapTypeId: google.maps.MapTypeId.ROADMAP#}
{#        };#}
{#        console.log(markers[0].lat, markers[0].lng);#}
{#        var infoWindow = new google.maps.InfoWindow();#}
{#        var latlngbounds = new google.maps.LatLngBounds();#}
{#        var map = new google.maps.Map(document.getElementById("dvMap"), mapOptions);#}
{#            var data = markers[routeNumber];#}
{#            document.write(document.getElementById('foo').innerHTML = '121');#}
{#               var flightPath = new google.maps.Polyline({#}
{#                path: data,#}
{#                geodesic: true,#}
{#                strokeColor: '#FF0000',#}
{#                strokeOpacity: 10.0,#}
{#                strokeWeight: 1});#}
{#                flightPath.setMap(map)#}
{#            console.log(data);#}
{#            for (var c = 0; c < data.length; c++){#}
{#                var data1 = data[c];#}
{#                console.log(data1);#}
{#                var myLatlng = new google.maps.LatLng(data1.lat, data1.lng);#}
{#                var marker = new google.maps.Marker({#}
{#                    position: myLatlng,#}
{#                    map: map,#}
{#                    title: data1.title#}
{#                    });#}
{#                    (function (marker, data1) {#}
{#                    google.maps.event.addListener(marker, "click", function (e) {#}
{#                        infoWindow.setContent("<div style = 'width:200px;min-height:40px'>" + data1.description + "</div>");#}
{#                        infoWindow.open(map, marker);#}
{#                    });#}
{#                    })#}
{#                        (marker, data1);#}
{#                        latlngbounds.extend(marker.position);#}
{#            }#}
{#        var bounds = new google.maps.LatLngBounds();#}
{#        map.setCenter(latlngbounds.getCenter());#}
{#        map.fitBounds(latlngbounds);#}




{#    }#}
    function LoadMap(route) {
        var mapOptions = {
            center: new google.maps.LatLng(markers[0].lat, markers[0].lng),
            zoom: 2,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        };
{#        console.log(markers[0].lat, markers[0].lng);#}
        var infoWindow = new google.maps.InfoWindow();
        var latlngbounds = new google.maps.LatLngBounds();
        var map = new google.maps.Map(document.getElementById("dvMap"), mapOptions);
        var routeId = false;
        for (var i = 0; i < markers.length; i++){
            console.log(routeId);
            var data = markers[i];
            if (typeof route === "undefined" || route === null){
                route = 45646546
            }
            console.log(i);
            console.log(route)
            if (i==route){
                routeId = i;
                var color = '#00FF00';
                var weight = 3
            }
            else{
                var color = '#GF0000';
                var weight = 0.1
            }
{#            document.write(document.getElementById('foo').innerHTML = '121');#}
               var flightPath = new google.maps.Polyline({
                path: data,
                geodesic: true,
                strokeColor: color,
                strokeOpacity: 10.0,
                strokeWeight: weight});
                flightPath.setMap(map)
            console.log(data);
            for (var c = 0; c < data.length; c++){
                var data1 = data[c];
                console.log(data1);
                var myLatlng = new google.maps.LatLng(data1.lat, data1.lng);
                var marker = new google.maps.Marker({
                    position: myLatlng,
                    map: map,
                    label: data1.label,
                    title: data1.title
                    });
                if (data1.label=='S' && route==routeId){
                    marker.setIcon('http://maps.google.com/mapfiles/ms/icons/green.png')
                }
                else if (data1.label=='F' && route==routeId){
                    marker.setIcon('http://maps.google.com/mapfiles/ms/icons/red.png')
                }
                else{
                    marker.setIcon('http://maps.google.com/mapfiles/ms/icons/grey.png')
                }
                    (function (marker, data1) {
                    google.maps.event.addListener(marker, "click", function (e) {
                        console.log(routeId);
                        if (route==routeId){
                        infoWindow.setContent("<div style = 'width:200px;min-height:40px'>" + data1.description + "</div>");
                        infoWindow.open(map, marker);}
                    });
                    })
                        (marker, data1);
                        latlngbounds.extend(marker.position);
            }
            if (route==routeId){
                   break
            }
        }
        var bounds = new google.maps.LatLngBounds();
        map.setCenter(latlngbounds.getCenter());
        map.fitBounds(latlngbounds);
    }
</script>
<div id="dvMap" style="width: 800px; height: 600px">
</div>
    <button type="button" onclick="LoadMap();">Show all routes</button><br>
{% if routes %}
    <ul>
        {% for j in routes %}
            <li>"323232"</li>
                <button type="button" onclick="LoadMap({{ forloop.counter0 }})">Show route number: {{ forloop.counter }}</button>
        {% endfor %}
    </ul>
{% endif %}
</body>
</html>