# coding=utf-8
import requests
from django.core.mail import send_mail
from django.http import HttpResponse, HttpResponseRedirect
from django.shortcuts import render
from django.template.defaulttags import register
# Create your views here.
from books.forms import ContactForm
from books.models import Book
import json


text = '{"list":[{"id":0,"passengerOrderHashMap":[[{"id":2,"role":2,"phoneNumber":"0666076706","fbProfile":{"id":"id_link2","type":2,"link":"https://plus.google.com/+AlexanderZhovnuvaty","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя2","surName":"Фамилия2","gender":2,"age":34,"email":"email2","birthday":"1983-03-26"}},{"id":1576,"totalSeats":2,"depLocation":{"mLongitudeE6":24007593,"mLatitudeE6":49823836,"mAltitude":0},"destLocation":{"mLongitudeE6":24053202,"mLatitudeE6":49864560,"mAltitude":0},"depAddress":"From 1","destAddress":"To 1","timestamp":1444904927000,"clientType":1,"stateId":1,"price":40,"polygon":"POLYGON((24.007575983305774 49.82098617345401,24.007436170646823 49.82099049023218,24.00729673821261 49.82100166209261,24.007158021908076 49.82101966212133,24.007020355912953 49.82104444695467,24.006884071876684 49.82107595688381,24.006749498119444 49.821114115998576,24.006616958841207 49.8211588323703,24.006486773340697 49.82120999827334,24.006359255246192 49.82126749044455,24.00623471175995 49.821331170380255,24.00611344291814 49.82140088466991,24.005995740868016 49.821476465365684,24.005881889164137 49.82155773038707,24.005772162085222 49.8216444839595,24.005666823973417 49.82173651708602,24.005566128597465 49.82183360805079,24.005470318541338 49.82193552295314,24.00537962461986 49.82204201627116,24.00529426532263 49.822152831453124,24.005214446287667 49.822267701535544,24.005140359806024 49.82238634978633,24.00507218435852 49.82250849037145,24.005010084185784 49.822633829043546,24.004954208892567 49.822762063850774,24.004904693087347 49.82289288586425,24.004861656058033 49.823025979922285,24.004825201484604 49.82316102538964,24.004795417189314 49.82329769692995,24.004772374925142 49.8234356652895,24.00475613020292 49.823574598090445,24.00474672215761 49.823714160631475,24.00474417345401 49.82385401669422,24.004748490232178 49.82399382935318,24.004759662092614 49.82413326178739,24.004777662121324 49.82427197809192,24.004802446954667 49.82440964408704,24.00483395688381 49.824545928123314,24.00487211599857 49.82468050188055,24.0049168323703 49.82481304115879,24.004967998273337 49.8249432266593,24.00502549044455 49.8250707447538,24.005089170380252 49.825195288240046,24.005158884669907 49.82531655708186,24.012933184542515 49.838103174384536,24.012966295275298 49.83815630888119,24.013044443273927 49.83827232226183,24.013128189646643 49.83838436135872,24.01321733264111 49.838492156259875,24.023059674389405 49.84981610032652,24.023151572234674 49.84991685809981,24.023250730352228 49.85001551853717,24.023354610067692 49.8501091946755,24.02346296112574 49.850197660840756,24.02357552249918 49.85028070391022,24.03653164776279 49.85935675980257,24.036646015948143 49.85943283561962,24.036766111568692 49.859504552117734,24.036889581490584 49.859570289417384,24.05192481460607 49.86710767215571,24.05199941937839 49.867143725177336,24.05212764532497 49.8671996208015,24.052258459486065 49.86724915734795,24.052391546718898 49.867292215478805,24.052526586404678 49.86732869146326,24.052663253220963 49.86735849742747,24.05280121792543 49.867381561566255,24.05294014814902 49.86739782831609,24.053079709196652 49.867407258488946,24.053219564853542 49.867409829366714,24.053359378195164 49.867405534755925,24.053498812398924 49.86739438500266,24.053637531555623 49.867376406967665,24.05377520147865 49.8673516439616,24.053911490509115 49.86732015564071,24.054046070314794 49.86728201786312,24.054178616681156 49.86723732250608,24.05430881029239 49.86718617724461,24.054436337500686 49.86712870529214,24.054560891081827 49.86706504510362,24.054682170975326 49.86699535004204,24.0547998850073 49.86691978800889,24.05491374959433 49.86683854103974,24.05502349042666 49.86675180486564,24.055128843129005 49.866659788441645,24.055229553897483 49.86656271344338,24.055325380111025 49.866460813733,24.055416090915898 49.86635433479585,24.05550146778182 49.86624353314902,24.055581305028447 49.86612867572337,24.05565541032086 49.86601003922049,24.055723605132915 49.86588790944613,24.055785725177337 49.865762580621606,24.055841620801502 49.865634354675024,24.05589115734795 49.865503540513934,24.055934215478807 49.865370453281095,24.055970691463262 49.86523541359532,24.05600049742747 49.86509874677903,24.056023561566256 49.86496078207456,24.05603982831609 49.86482185185098,24.05604925848895 49.864682290803344,24.056051829366716 49.864542435146454,24.056047534755923 49.864402621804835,24.056036385002663 49.86426318760107,24.05601840696767 49.86412446844437,24.055993643961603 49.863986798521346,24.055962155640714 49.86385050949088,24.055924017863124 49.8637159296852,24.05587932250608 49.86358338331884,24.055828177244614 49.863453189707606,24.05577070529214 49.863325662499314,24.055707045103627 49.86320110891817,24.055637350042044 49.86307982902467,24.047868188820505 49.85029709823012,24.047834701394123 49.85024335528382,24.04775654265666 49.85012734913771,24.047672785913022 49.85001531779356,24.04758363294054 49.849907531144694,24.0377393482322 49.83858346895387,24.037647531187346 49.83848281386243,24.037548368449748 49.83838415806864,24.03744448434765 49.83829048679499,24.03733612914695 49.83820202570377,24.037223563884822 49.838118987905524,24.024266316056092 49.82904305013735,24.02415242183641 49.82896728101203,24.024032337068235 49.828895546343766,24.023908877094087 49.82882979036336,24.008871570852694 49.821288521116905,24.00879617095645 49.82125208418579,24.008667936149223 49.82119620889257,24.00853711413575 49.82114669308735,24.008404020077712 49.821103656058035,24.00826897461036 49.8210672014846,24.00813230307005 49.821037417189316,24.007994334710492 49.82101437492514,24.007855401909556 49.82099813020292,24.00771583936852 49.82098872215761,24.007575983305774 49.82098617345401))"}],[{"id":1,"role":2,"phoneNumber":"0666076705","gPlusProfile":{"id":"id_link1","type":1,"link":"https://plus.google.com/118055503722424615520","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя1","surName":"Фамилия1","gender":1,"age":33,"email":"email1","birthday":"1982-03-25"}},{"id":1575,"totalSeats":2,"depLocation":{"mLongitudeE6":23990761,"mLatitudeE6":49811403,"mAltitude":0},"destLocation":{"mLongitudeE6":24010512,"mLatitudeE6":49826688,"mAltitude":0},"depAddress":"From 0","destAddress":"To 0","timestamp":1444904927000,"clientType":1,"stateId":1,"price":40,"polygon":"POLYGON((23.99076330186452 49.81027401069995,23.990707902212527 49.810275257669865,23.990652630477758 49.810279221469834,23.99059761981466 49.81028589255071,23.990543002748737 49.810295254841286,23.990488910857287 49.81030728578697,23.990435474452415 49.81032195640417,23.9903828222671 49.81033923135008,23.99033108114507 49.81035906900784,23.990280375735214 49.8103814215868,23.99023082819131 49.810406235237636,23.990182557877734 49.810433450182096,23.99013568108189 49.810463000856984,23.990090310734097 49.81049481607214,23.99004655613549 49.81052881918193,23.99000452269473 49.810564928269876,23.989964311674058 49.81060305634603,23.989926019945344 49.810643111556516,23.989889739756716 49.81068499740481,23.989855558510328 49.810728612984256,23.989823558551798 49.81077385322109,23.989793816971826 49.810820609127624,23.989766405420482 49.81086876806477,23.9897413899346 49.810918214013455,23.98971883077867 49.81096882785403,23.98969878229968 49.811020487653344,23.989681292796167 49.8110730689584,23.98966640440188 49.811126445096235,23.989654152984265 49.81118048747906,23.989644568058058 49.81123506591403,23.98963767271419 49.81129004891693,23.98963348356414 49.81134530402888,23.989632010699946 49.81140069813548,23.989633257669862 49.81145609778747,23.98963722146983 49.811511369522236,23.989643892550713 49.81156638018534,23.989653254841283 49.81162099725126,23.98966528578697 49.81167508914271,23.98967995640417 49.81172852554758,23.98969723135008 49.8117811777329,23.989717069007842 49.81183291885493,23.9897394215868 49.81188362426479,23.989764235237637 49.81193317180869,23.989791450182093 49.81198144212227,23.98982100085698 49.8120283189181,23.98985281607214 49.8120736892659,23.99347041648895 49.81697230136988,23.993476607600293 49.81698060481172,23.993511010683196 49.81702404562503,23.993547503865763 49.81706574603272,23.993585999232714 49.81710560557484,23.997919518451305 49.821377720446975,23.99795486619155 49.821411097479526,23.99799686615964 49.82144724549545,23.998040589236 49.82148128912875,23.99808593008791 49.82151314636533,23.998132779485292 49.82154274045831,24.003699052690333 49.82487062558414,24.003718863618655 49.82488219824715,24.00376765267773 49.82490847188583,24.003817672154593 49.82493231991109,24.01005127931415 49.82771870780915,24.010064992072113 49.82772472853275,24.01011640037075 49.827745413387255,24.010168761703543 49.827763550840295,24.01022194992746 49.82777909719715,24.010275836907404 49.827792015005286,24.01033029282492 49.82780227314458,24.010385186490943 49.82780984690227,24.010440385661816 49.827814718032506,24.010495757357898 49.82781687480031,24.01055116818393 49.82781631200985,24.010606484650378 49.82781303101693,24.010661573495025 49.82780703972574,24.010716302004024 49.82779835256984,24.0107705383316 49.82778699047735,24.010824151817687 49.827772980820534,24.010877013302704 49.827756357349884,24.010928995438704 49.827737160112804,24.010979972996168 49.82771543535712,24.011029823165696 49.827691235419664,24.01107842585386 49.82766461860022,24.011125663972532 49.82763564902101,24.011171423720942 49.82760439647231,24.01121559485985 49.82757093624424,24.01125807097711 49.82753534894543,24.01129874974404 49.827497720308784,24.011337533161928 49.827458140984994,24.011374327798116 49.827416706324115,24.01140904501111 49.82737351614587,24.0114416011641 49.827328674499185,24.011471917826462 49.82728228941152,24.011499921962702 49.82723447262861,24.011525546108402 49.82718533934527,24.011548728532752 49.82713500792788,24.011569413387257 49.82708359962925,24.011587550840293 49.82703123829645,24.01160309719715 49.82697805007254,24.01161601500529 49.82692416309259,24.011626273144582 49.82686970717507,24.01163384690227 49.82681481350905,24.011638718032508 49.82675961433818,24.011640874800317 49.826704242642094,24.011640312009852 49.826648831816065,24.011637031016928 49.826593515349614,24.011631039725746 49.82653842650497,24.011622352569844 49.826483697995975,24.01161099047735 49.8264294616684,24.011596980820535 49.82637584818231,24.01158035734989 49.82632298669729,24.01156116011281 49.82627100456129,24.011539435357122 49.82622002700383,24.01151523541967 49.826170176834296,24.011488618600215 49.826121574146136,24.011459649021013 49.82607433602747,24.011428396472315 49.82602857627906,24.007837943446397 49.8210389491509,24.007815719140435 49.82100911364983,24.007780821723866 49.820966068944095,24.007743854239163 49.820924788422666,24.007704905744234 49.82088537153393,24.003271116333416 49.8166132410244,24.00325168953936 49.8165949601755,24.003209980266224 49.81655847712589,24.003166531095335 49.81652408459874,24.003121446699556 49.81649186544866,24.00307483569114 49.81646189729441,23.997608417551213 49.81313402780597,23.997567291847545 49.81311016333703,23.997518145080218 49.813084565062944,23.997467801464552 49.81306140914067,23.991207462041217 49.8103660362668,23.991195172145964 49.81036083077867,23.991143512346653 49.81034078229968,23.991090931041594 49.81032329279617,23.99103755490376 49.81030840440188,23.990983512520938 49.810296152984264,23.990928934085964 49.81028656805806,23.990873951083067 49.81027967271419,23.990818695971118 49.81027548356414,23.99076330186452 49.81027401069995))"}],[{"id":5,"role":2,"phoneNumber":"0666076708","vkProfile":{"id":"id_link8","type":3,"link":"https://www.facebook.com/app_scoped_user_id/1637344933216693/","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя8","surName":"Фамилия8","gender":2,"age":34,"email":"email8","birthday":"1983-03-28"}},{"id":1578,"totalSeats":2,"depLocation":{"mLongitudeE6":24017314,"mLatitudeE6":49812844,"mAltitude":0},"destLocation":{"mLongitudeE6":24000663,"mLatitudeE6":49816720,"mAltitude":0},"depAddress":"From 3","destAddress":"To 3","timestamp":1444904927000,"clientType":1,"stateId":1,"price":40,"polygon":"POLYGON((24.01731968267015 49.81219603114531,24.017287881500387 49.81219653281676,24.012892885206675 49.81237382475058,24.012883489997005 49.812374272068716,24.0128517850148 49.8123767940076,24.01282024196831 49.81238086859844,24.008499809458893 49.81304713636209,24.008489763894296 49.81304876638168,24.008458550855075 49.81305487475749,24.00842767513712 49.81306250732674,24.008397211122745 49.813071645701896,24.004317632019184 49.81440537793822,24.004317135295654 49.81440554055326,24.0042871649528 49.81441618689637,24.004257753101832 49.81442829099052,24.000401761008522 49.81612699905673,24.000396014009652 49.81612956421996,24.000367364295403 49.81614337580734,24.000339426793463 49.81615857653291,24.00031226880772 49.81617512977678,24.000285955764138 49.81619299566075,24.000260551053145 49.816212131144326,24.000236115876916 49.81623249012846,24.000212709101927 49.81625402356658,24.000190387117158 49.81627667958274,24.000169203698217 49.81630040359662,24.000149209877815 49.816325138454985,24.000130453822823 49.81635082456939,24.00011298071822 49.81637740005976,24.00009683265824 49.81640480090338,24.00008204854498 49.816432961089234,24.000068663994654 49.81646181277697,24.000056711251826 49.816491286460334,24.0000462191117 49.81652131113466,24.000037212850753 49.81655181446786,24.000029714165862 49.81658272297473,24.000023741122018 49.81661396219398,24.0000193081088 49.816645456867604,24.00001642580573 49.816677131122155,24.000015101156524 49.81670890865159,24.000015337352387 49.81674071290105,24.000017133824294 49.816772467251326,24.000020486244388 49.81680409520339,24.000025386536397 49.81683552056275,24.00003182289509 49.816866667622946,24.000039779814713 49.816897461348,24.000049238126348 49.816927827553116,24.000060175044098 49.81695769308346,24.000072564219966 49.81698698599035,24.000086375807346 49.81701563570459,24.000101576532913 49.81704357320653,24.000118129776787 49.817070731192274,24.000135995660752 49.81709704423586,24.00015513114433 49.817122448946854,24.000175490128466 49.81714688412308,24.000197023566585 49.81717029089807,24.000219679582745 49.81719261288284,24.00024340359662 49.81721379630178,24.000268138454985 49.81723379012218,24.000293824569397 49.81725254617717,24.000320400059756 49.81727001928178,24.00034780090338 49.817286167341756,24.000375961089237 49.81730095145502,24.00040481277697 49.81731433600534,24.00043428646034 49.81732628874817,24.00046431113466 49.8173367808883,24.000494814467856 49.81734578714924,24.000525722974732 49.81735328583413,24.000556962193986 49.81735925887798,24.000588456867604 49.817363691891195,24.000620131122158 49.81736657419427,24.00065190865159 49.81736789884347,24.000683712901054 49.81736766264761,24.005101729851678 49.817226370034405,24.005116530812987 49.81722572724349,24.005148235794596 49.817223205297104,24.005179778840123 49.8172191306988,24.0095002091488 49.816552862228036,24.009510255434275 49.81655123208321,24.00954146846515 49.81654512366477,24.009572344172682 49.81653749105335,24.009602808174577 49.81652835263659,24.013682366251974 49.81519462110739,24.013689030413744 49.815192402340934,24.013718892422574 49.815181455811754,24.013748181340578 49.81516905720882,24.01758117600388 49.813434349821996,24.017585905311233 49.81343218656148,24.01761443873602 49.813418136303746,24.017642248377577 49.81340270290137,24.01766926724004 49.81338592353477,24.017695430232607 49.8133678386269,24.01772067432633 49.813348491745906,24.017744938705984 49.8133279295001,24.01776816491655 49.81330620142574,24.017790297004048 49.81328335986767,24.017811281650346 49.813259459853185,24.017831068301593 49.81323455895953,24.01784960929001 49.81320871717513,24.017866859948736 49.81318199675511,24.017882778719418 49.8131544620713,24.017897327252346 49.81312617945717,24.01791047049883 49.81309721704802,24.01792217679564 49.81306764461681,24.017932417941278 49.81303753340613,24.017941169263928 49.813006955956524,24.017948409680887 49.81297598593175,24.017954121749355 49.812944697941305,24.017958291708464 49.8129131673607,24.017960909512414 49.812881470149854,24.017961968854685 49.81284968267015,24.01796146718323 49.812817881500386,24.01795940570662 49.812786143252374,24.01795578939113 49.812754544386344,24.017950626948785 49.81272316102672,24.017943930816358 49.81269206877876,24.017935717125418 49.81266134254643,24.017926005663465 49.81263105635189,24.017914819826267 49.812601283157264,24.01790218656148 49.81257209468876,24.017888136303746 49.81254356126398,24.01787270290137 49.81251575162242,24.017855923534768 49.81248873275995,24.017837838626903 49.81246256976739,24.017818491745903 49.81243732567366,24.017797929500098 49.81241306129401,24.017776201425743 49.81238983508345,24.017753359867665 49.81236770299595,24.017729459853186 49.81234671834965,24.01770455895953 49.8123269316984,24.01767871717513 49.81230839070999,24.017651996755113 49.812291140051265,24.017624462071304 49.81227522128058,24.017596179457176 49.81226067274765,24.017567217048015 49.812247529501164,24.01753764461681 49.81223582320436,24.017507533406132 49.81222558205872,24.01747695595653 49.81221683073607,24.01744598593175 49.812209590319114,24.017414697941305 49.81220387825064,24.017383167360695 49.81219970829153,24.01735147014986 49.81219709048759,24.01731968267015 49.81219603114531))"}]],"stops":{"0":{"passengerId":5,"orderId":1578,"type":1,"length":1000},"1":{"passengerId":1,"orderId":1575,"type":1,"length":1000},"2":{"passengerId":5,"orderId":1578,"type":2,"length":1000},"3":{"passengerId":2,"orderId":1576,"type":1,"length":1000},"4":{"passengerId":1,"orderId":1575,"type":2,"length":1000},"5":{"passengerId":2,"orderId":1576,"type":2,"length":1000}},"stateId":1,"price":0},{"id":0,"passengerOrderHashMap":[[{"id":2,"role":2,"phoneNumber":"0666076706","fbProfile":{"id":"id_link2","type":2,"link":"https://plus.google.com/+AlexanderZhovnuvaty","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя2","surName":"Фамилия2","gender":2,"age":34,"email":"email2","birthday":"1983-03-26"}},{"id":1576,"totalSeats":2,"depLocation":{"mLongitudeE6":24007593,"mLatitudeE6":49823836,"mAltitude":0},"destLocation":{"mLongitudeE6":24053202,"mLatitudeE6":49864560,"mAltitude":0},"depAddress":"From 1","destAddress":"To 1","timestamp":1444904927000,"clientType":1,"stateId":1,"price":30,"polygon":"POLYGON((24.007575983305774 49.82098617345401,24.007436170646823 49.82099049023218,24.00729673821261 49.82100166209261,24.007158021908076 49.82101966212133,24.007020355912953 49.82104444695467,24.006884071876684 49.82107595688381,24.006749498119444 49.821114115998576,24.006616958841207 49.8211588323703,24.006486773340697 49.82120999827334,24.006359255246192 49.82126749044455,24.00623471175995 49.821331170380255,24.00611344291814 49.82140088466991,24.005995740868016 49.821476465365684,24.005881889164137 49.82155773038707,24.005772162085222 49.8216444839595,24.005666823973417 49.82173651708602,24.005566128597465 49.82183360805079,24.005470318541338 49.82193552295314,24.00537962461986 49.82204201627116,24.00529426532263 49.822152831453124,24.005214446287667 49.822267701535544,24.005140359806024 49.82238634978633,24.00507218435852 49.82250849037145,24.005010084185784 49.822633829043546,24.004954208892567 49.822762063850774,24.004904693087347 49.82289288586425,24.004861656058033 49.823025979922285,24.004825201484604 49.82316102538964,24.004795417189314 49.82329769692995,24.004772374925142 49.8234356652895,24.00475613020292 49.823574598090445,24.00474672215761 49.823714160631475,24.00474417345401 49.82385401669422,24.004748490232178 49.82399382935318,24.004759662092614 49.82413326178739,24.004777662121324 49.82427197809192,24.004802446954667 49.82440964408704,24.00483395688381 49.824545928123314,24.00487211599857 49.82468050188055,24.0049168323703 49.82481304115879,24.004967998273337 49.8249432266593,24.00502549044455 49.8250707447538,24.005089170380252 49.825195288240046,24.005158884669907 49.82531655708186,24.012933184542515 49.838103174384536,24.012966295275298 49.83815630888119,24.013044443273927 49.83827232226183,24.013128189646643 49.83838436135872,24.01321733264111 49.838492156259875,24.023059674389405 49.84981610032652,24.023151572234674 49.84991685809981,24.023250730352228 49.85001551853717,24.023354610067692 49.8501091946755,24.02346296112574 49.850197660840756,24.02357552249918 49.85028070391022,24.03653164776279 49.85935675980257,24.036646015948143 49.85943283561962,24.036766111568692 49.859504552117734,24.036889581490584 49.859570289417384,24.05192481460607 49.86710767215571,24.05199941937839 49.867143725177336,24.05212764532497 49.8671996208015,24.052258459486065 49.86724915734795,24.052391546718898 49.867292215478805,24.052526586404678 49.86732869146326,24.052663253220963 49.86735849742747,24.05280121792543 49.867381561566255,24.05294014814902 49.86739782831609,24.053079709196652 49.867407258488946,24.053219564853542 49.867409829366714,24.053359378195164 49.867405534755925,24.053498812398924 49.86739438500266,24.053637531555623 49.867376406967665,24.05377520147865 49.8673516439616,24.053911490509115 49.86732015564071,24.054046070314794 49.86728201786312,24.054178616681156 49.86723732250608,24.05430881029239 49.86718617724461,24.054436337500686 49.86712870529214,24.054560891081827 49.86706504510362,24.054682170975326 49.86699535004204,24.0547998850073 49.86691978800889,24.05491374959433 49.86683854103974,24.05502349042666 49.86675180486564,24.055128843129005 49.866659788441645,24.055229553897483 49.86656271344338,24.055325380111025 49.866460813733,24.055416090915898 49.86635433479585,24.05550146778182 49.86624353314902,24.055581305028447 49.86612867572337,24.05565541032086 49.86601003922049,24.055723605132915 49.86588790944613,24.055785725177337 49.865762580621606,24.055841620801502 49.865634354675024,24.05589115734795 49.865503540513934,24.055934215478807 49.865370453281095,24.055970691463262 49.86523541359532,24.05600049742747 49.86509874677903,24.056023561566256 49.86496078207456,24.05603982831609 49.86482185185098,24.05604925848895 49.864682290803344,24.056051829366716 49.864542435146454,24.056047534755923 49.864402621804835,24.056036385002663 49.86426318760107,24.05601840696767 49.86412446844437,24.055993643961603 49.863986798521346,24.055962155640714 49.86385050949088,24.055924017863124 49.8637159296852,24.05587932250608 49.86358338331884,24.055828177244614 49.863453189707606,24.05577070529214 49.863325662499314,24.055707045103627 49.86320110891817,24.055637350042044 49.86307982902467,24.047868188820505 49.85029709823012,24.047834701394123 49.85024335528382,24.04775654265666 49.85012734913771,24.047672785913022 49.85001531779356,24.04758363294054 49.849907531144694,24.0377393482322 49.83858346895387,24.037647531187346 49.83848281386243,24.037548368449748 49.83838415806864,24.03744448434765 49.83829048679499,24.03733612914695 49.83820202570377,24.037223563884822 49.838118987905524,24.024266316056092 49.82904305013735,24.02415242183641 49.82896728101203,24.024032337068235 49.828895546343766,24.023908877094087 49.82882979036336,24.008871570852694 49.821288521116905,24.00879617095645 49.82125208418579,24.008667936149223 49.82119620889257,24.00853711413575 49.82114669308735,24.008404020077712 49.821103656058035,24.00826897461036 49.8210672014846,24.00813230307005 49.821037417189316,24.007994334710492 49.82101437492514,24.007855401909556 49.82099813020292,24.00771583936852 49.82098872215761,24.007575983305774 49.82098617345401))"}],[{"id":4,"role":2,"phoneNumber":"0666076707","vkProfile":{"id":"id_link5","type":3,"link":"https://plus.google.com/118055503722424615520","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя5","surName":"Фамилия5","gender":2,"age":34,"email":"email5","birthday":"1983-03-27"}},{"id":1577,"totalSeats":2,"depLocation":{"mLongitudeE6":24017829,"mLatitudeE6":49801100,"mAltitude":0},"destLocation":{"mLongitudeE6":24029501,"mLatitudeE6":49844071,"mAltitude":0},"depAddress":"From 2","destAddress":"To 2","timestamp":1444904927000,"clientType":1,"stateId":1,"price":30,"polygon":"POLYGON((24.017802910582834 49.79862514684481,24.017681506720052 49.79862940806085,24.017560458181503 49.79863962114926,24.017440056583713 49.798655761505835,24.01732059198468 49.798677790247034,24.01720235218509 49.79870565430368,24.017085622034973 49.79873928654883,24.016970682747488 49.79877860595946,24.016857811221442 49.79882351781166,24.01674727937423 49.79887391390885,24.01663935348675 49.79892967284242,24.016534293561925 49.798990660284204,24.01643235269831 49.799056729310124,24.016333776480376 49.79912772075411,24.01623880238687 49.79920346359154,24.016147659218696 49.7992837753513,24.016060566547733 49.79936846255532,24.015977734187853 49.79945732118471,24.015899361689467 49.79955013717125,24.015825637858786 49.79964668691309,24.01575674030298 49.79974673781346,24.01569283500229 49.799850048840966,24.015634075910185 49.79995637111029,24.015580604582468 49.80006544848179,24.015532549836244 49.80017701817851,24.01549002743961 49.80029081141927,24.015453139832747 49.800406554066214,24.01542197588113 49.800523967285145,24.01539661066144 49.80064276821734,24.01537710528072 49.80076267066095,24.013781126140348 49.81236312272178,24.01377334998497 49.812425501181984,24.01376282156608 49.81254652270179,24.013758244073653 49.8126679150509,24.01375962853527 49.81278938578452,24.013766971615635 49.81291064226901,24.014708205700217 49.82395363814743,24.014710395002684 49.82397791112604,24.01472486739318 49.82409852458206,24.01474524057283 49.82421828262735,24.01477146546085 49.82433689675429,24.0148034788792 49.824454081211044,24.014841203704744 49.82456955369001,24.014884549055076 49.82468303600786,24.01493341050745 49.82479425477575,24.01979015579809 49.83515125882933,24.019798869968366 49.835169644805575,24.019854021471758 49.835277882356976,24.019914417507668 49.835383283375506,24.019979912576762 49.83548559394087,24.020050348895676 49.83558456757795,24.027521348660823 49.845555115585135,24.027595417862745 49.8456491392053,24.027675150044995 49.845740789818905,24.027759283268804 49.845828417762576,24.027847614849858 49.84591181193293,24.02793993198965 49.845990771426095,24.028036012288094 49.84606510602175,24.028135624279347 49.846134636641324,24.02823852798939 49.846199195779484,24.02834447551417 49.8462586279076,24.028453211616828 49.846312789848476,24.028564474342563 49.84636155112125,24.028677995649726 49.84640479425574,24.02879350205554 49.84644241507546,24.02891071529496 49.846474322948545,24.029029352991024 49.84650044100614,24.029149129335135 49.84652070632756,24.029269755775584 49.84653507009187,24.02939094171271 49.84654349769549,24.029512395198978 49.84654596883561,24.029633823642303 49.84654247755902,24.029754934510926 49.84653303227651,24.029875436038157 49.8465176557426,24.029995037925264 49.846496385000705,24.030113452040823 49.846469271293905,24.03023039311486 49.846436379941494,24.030345579426083 49.84639779018162,24.030458733480582 49.8463535949804,24.03056958268032 49.84630390080793,24.03067785997988 49.84624882738185,24.030783304529752 49.84618850737884,24.03088566230478 49.846123086115085,24.030984686716124 49.84605272119614,24.0310801392053 49.84597758213725,24.031171789818902 49.845897849955,24.031259417762573 49.84581371673119,24.031342811932927 49.84572538515014,24.031421771426093 49.84563306801035,24.031496106021745 49.8455369877119,24.031565636641325 49.84543737572065,24.03163019577948 49.845334472010606,24.0316896279076 49.845228524485826,24.031743789848477 49.845119788383165,24.03179255112125 49.845008525657434,24.03183579425574 49.84489500435027,24.031873415075456 49.84477949794446,24.031905322948543 49.84466228470504,24.031931441006137 49.84454364700897,24.031951706327558 49.84442387066486,24.033618554831683 49.832852239089235,24.033628572770976 49.83277384124354,24.033639077668276 49.832652817679744,24.033643631567152 49.83253142444325,24.033642223496866 49.832409953981006,24.03363485684958 49.832288698925986,24.03269144489051 49.82124551620568,24.032689260257243 49.82122134211218,24.032674769244796 49.82110073089206,24.032654377575337 49.82098097599372,24.032628134374185 49.82086236591719,24.032596102863515 49.820745186404544,24.032558360210036 49.82062971975149,24.032514997339106 49.8205162441273,24.032466118715686 49.820405032904695,24.027607510231483 49.810048215693,24.027595858254728 49.810023727663754,24.027540394096366 49.80991564999262,24.027479693627047 49.80981042400303,24.02741390307951 49.80970830319362,24.02734318094895 49.80960953358235,24.0198053528881 49.79961016508998,24.019801279245893 49.79960477648038,24.01972553640846 49.799509802386865,24.0196452246487 49.799418659218695,24.019560537444676 49.799331566547735,24.019471678815286 49.799248734187856,24.01937886282875 49.79917036168947,24.019282313086904 49.79909663785879,24.01918226218654 49.799027740302975,24.019078951159035 49.79896383500229,24.018972628889703 49.798905075910184,24.01886355151821 49.79885160458247,24.01875198182149 49.798803549836244,24.01863818858072 49.79876102743961,24.018522445933783 49.79872413983275,24.018405032714853 49.798692975881124,24.018286231782657 49.79866761066144,24.01816632933905 49.79864810528072,24.018045614239515 49.79863450672914,24.017924377297305 49.7986268477668,24.017802910582834 49.79862514684481))"}],[{"id":1,"role":2,"phoneNumber":"0666076705","gPlusProfile":{"id":"id_link1","type":1,"link":"https://plus.google.com/118055503722424615520","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя1","surName":"Фамилия1","gender":1,"age":33,"email":"email1","birthday":"1982-03-25"}},{"id":1575,"totalSeats":2,"depLocation":{"mLongitudeE6":23990761,"mLatitudeE6":49811403,"mAltitude":0},"destLocation":{"mLongitudeE6":24010512,"mLatitudeE6":49826688,"mAltitude":0},"depAddress":"From 0","destAddress":"To 0","timestamp":1444904927000,"clientType":1,"stateId":1,"price":30,"polygon":"POLYGON((23.99076330186452 49.81027401069995,23.990707902212527 49.810275257669865,23.990652630477758 49.810279221469834,23.99059761981466 49.81028589255071,23.990543002748737 49.810295254841286,23.990488910857287 49.81030728578697,23.990435474452415 49.81032195640417,23.9903828222671 49.81033923135008,23.99033108114507 49.81035906900784,23.990280375735214 49.8103814215868,23.99023082819131 49.810406235237636,23.990182557877734 49.810433450182096,23.99013568108189 49.810463000856984,23.990090310734097 49.81049481607214,23.99004655613549 49.81052881918193,23.99000452269473 49.810564928269876,23.989964311674058 49.81060305634603,23.989926019945344 49.810643111556516,23.989889739756716 49.81068499740481,23.989855558510328 49.810728612984256,23.989823558551798 49.81077385322109,23.989793816971826 49.810820609127624,23.989766405420482 49.81086876806477,23.9897413899346 49.810918214013455,23.98971883077867 49.81096882785403,23.98969878229968 49.811020487653344,23.989681292796167 49.8110730689584,23.98966640440188 49.811126445096235,23.989654152984265 49.81118048747906,23.989644568058058 49.81123506591403,23.98963767271419 49.81129004891693,23.98963348356414 49.81134530402888,23.989632010699946 49.81140069813548,23.989633257669862 49.81145609778747,23.98963722146983 49.811511369522236,23.989643892550713 49.81156638018534,23.989653254841283 49.81162099725126,23.98966528578697 49.81167508914271,23.98967995640417 49.81172852554758,23.98969723135008 49.8117811777329,23.989717069007842 49.81183291885493,23.9897394215868 49.81188362426479,23.989764235237637 49.81193317180869,23.989791450182093 49.81198144212227,23.98982100085698 49.8120283189181,23.98985281607214 49.8120736892659,23.99347041648895 49.81697230136988,23.993476607600293 49.81698060481172,23.993511010683196 49.81702404562503,23.993547503865763 49.81706574603272,23.993585999232714 49.81710560557484,23.997919518451305 49.821377720446975,23.99795486619155 49.821411097479526,23.99799686615964 49.82144724549545,23.998040589236 49.82148128912875,23.99808593008791 49.82151314636533,23.998132779485292 49.82154274045831,24.003699052690333 49.82487062558414,24.003718863618655 49.82488219824715,24.00376765267773 49.82490847188583,24.003817672154593 49.82493231991109,24.01005127931415 49.82771870780915,24.010064992072113 49.82772472853275,24.01011640037075 49.827745413387255,24.010168761703543 49.827763550840295,24.01022194992746 49.82777909719715,24.010275836907404 49.827792015005286,24.01033029282492 49.82780227314458,24.010385186490943 49.82780984690227,24.010440385661816 49.827814718032506,24.010495757357898 49.82781687480031,24.01055116818393 49.82781631200985,24.010606484650378 49.82781303101693,24.010661573495025 49.82780703972574,24.010716302004024 49.82779835256984,24.0107705383316 49.82778699047735,24.010824151817687 49.827772980820534,24.010877013302704 49.827756357349884,24.010928995438704 49.827737160112804,24.010979972996168 49.82771543535712,24.011029823165696 49.827691235419664,24.01107842585386 49.82766461860022,24.011125663972532 49.82763564902101,24.011171423720942 49.82760439647231,24.01121559485985 49.82757093624424,24.01125807097711 49.82753534894543,24.01129874974404 49.827497720308784,24.011337533161928 49.827458140984994,24.011374327798116 49.827416706324115,24.01140904501111 49.82737351614587,24.0114416011641 49.827328674499185,24.011471917826462 49.82728228941152,24.011499921962702 49.82723447262861,24.011525546108402 49.82718533934527,24.011548728532752 49.82713500792788,24.011569413387257 49.82708359962925,24.011587550840293 49.82703123829645,24.01160309719715 49.82697805007254,24.01161601500529 49.82692416309259,24.011626273144582 49.82686970717507,24.01163384690227 49.82681481350905,24.011638718032508 49.82675961433818,24.011640874800317 49.826704242642094,24.011640312009852 49.826648831816065,24.011637031016928 49.826593515349614,24.011631039725746 49.82653842650497,24.011622352569844 49.826483697995975,24.01161099047735 49.8264294616684,24.011596980820535 49.82637584818231,24.01158035734989 49.82632298669729,24.01156116011281 49.82627100456129,24.011539435357122 49.82622002700383,24.01151523541967 49.826170176834296,24.011488618600215 49.826121574146136,24.011459649021013 49.82607433602747,24.011428396472315 49.82602857627906,24.007837943446397 49.8210389491509,24.007815719140435 49.82100911364983,24.007780821723866 49.820966068944095,24.007743854239163 49.820924788422666,24.007704905744234 49.82088537153393,24.003271116333416 49.8166132410244,24.00325168953936 49.8165949601755,24.003209980266224 49.81655847712589,24.003166531095335 49.81652408459874,24.003121446699556 49.81649186544866,24.00307483569114 49.81646189729441,23.997608417551213 49.81313402780597,23.997567291847545 49.81311016333703,23.997518145080218 49.813084565062944,23.997467801464552 49.81306140914067,23.991207462041217 49.8103660362668,23.991195172145964 49.81036083077867,23.991143512346653 49.81034078229968,23.991090931041594 49.81032329279617,23.99103755490376 49.81030840440188,23.990983512520938 49.810296152984264,23.990928934085964 49.81028656805806,23.990873951083067 49.81027967271419,23.990818695971118 49.81027548356414,23.99076330186452 49.81027401069995))"}],[{"id":5,"role":2,"phoneNumber":"0666076708","vkProfile":{"id":"id_link8","type":3,"link":"https://www.facebook.com/app_scoped_user_id/1637344933216693/","imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz=50","name":"Имя8","surName":"Фамилия8","gender":2,"age":34,"email":"email8","birthday":"1983-03-28"}},{"id":1578,"totalSeats":2,"depLocation":{"mLongitudeE6":24017314,"mLatitudeE6":49812844,"mAltitude":0},"destLocation":{"mLongitudeE6":24000663,"mLatitudeE6":49816720,"mAltitude":0},"depAddress":"From 3","destAddress":"To 3","timestamp":1444904927000,"clientType":1,"stateId":1,"price":30,"polygon":"POLYGON((24.01731968267015 49.81219603114531,24.017287881500387 49.81219653281676,24.012892885206675 49.81237382475058,24.012883489997005 49.812374272068716,24.0128517850148 49.8123767940076,24.01282024196831 49.81238086859844,24.008499809458893 49.81304713636209,24.008489763894296 49.81304876638168,24.008458550855075 49.81305487475749,24.00842767513712 49.81306250732674,24.008397211122745 49.813071645701896,24.004317632019184 49.81440537793822,24.004317135295654 49.81440554055326,24.0042871649528 49.81441618689637,24.004257753101832 49.81442829099052,24.000401761008522 49.81612699905673,24.000396014009652 49.81612956421996,24.000367364295403 49.81614337580734,24.000339426793463 49.81615857653291,24.00031226880772 49.81617512977678,24.000285955764138 49.81619299566075,24.000260551053145 49.816212131144326,24.000236115876916 49.81623249012846,24.000212709101927 49.81625402356658,24.000190387117158 49.81627667958274,24.000169203698217 49.81630040359662,24.000149209877815 49.816325138454985,24.000130453822823 49.81635082456939,24.00011298071822 49.81637740005976,24.00009683265824 49.81640480090338,24.00008204854498 49.816432961089234,24.000068663994654 49.81646181277697,24.000056711251826 49.816491286460334,24.0000462191117 49.81652131113466,24.000037212850753 49.81655181446786,24.000029714165862 49.81658272297473,24.000023741122018 49.81661396219398,24.0000193081088 49.816645456867604,24.00001642580573 49.816677131122155,24.000015101156524 49.81670890865159,24.000015337352387 49.81674071290105,24.000017133824294 49.816772467251326,24.000020486244388 49.81680409520339,24.000025386536397 49.81683552056275,24.00003182289509 49.816866667622946,24.000039779814713 49.816897461348,24.000049238126348 49.816927827553116,24.000060175044098 49.81695769308346,24.000072564219966 49.81698698599035,24.000086375807346 49.81701563570459,24.000101576532913 49.81704357320653,24.000118129776787 49.817070731192274,24.000135995660752 49.81709704423586,24.00015513114433 49.817122448946854,24.000175490128466 49.81714688412308,24.000197023566585 49.81717029089807,24.000219679582745 49.81719261288284,24.00024340359662 49.81721379630178,24.000268138454985 49.81723379012218,24.000293824569397 49.81725254617717,24.000320400059756 49.81727001928178,24.00034780090338 49.817286167341756,24.000375961089237 49.81730095145502,24.00040481277697 49.81731433600534,24.00043428646034 49.81732628874817,24.00046431113466 49.8173367808883,24.000494814467856 49.81734578714924,24.000525722974732 49.81735328583413,24.000556962193986 49.81735925887798,24.000588456867604 49.817363691891195,24.000620131122158 49.81736657419427,24.00065190865159 49.81736789884347,24.000683712901054 49.81736766264761,24.005101729851678 49.817226370034405,24.005116530812987 49.81722572724349,24.005148235794596 49.817223205297104,24.005179778840123 49.8172191306988,24.0095002091488 49.816552862228036,24.009510255434275 49.81655123208321,24.00954146846515 49.81654512366477,24.009572344172682 49.81653749105335,24.009602808174577 49.81652835263659,24.013682366251974 49.81519462110739,24.013689030413744 49.815192402340934,24.013718892422574 49.815181455811754,24.013748181340578 49.81516905720882,24.01758117600388 49.813434349821996,24.017585905311233 49.81343218656148,24.01761443873602 49.813418136303746,24.017642248377577 49.81340270290137,24.01766926724004 49.81338592353477,24.017695430232607 49.8133678386269,24.01772067432633 49.813348491745906,24.017744938705984 49.8133279295001,24.01776816491655 49.81330620142574,24.017790297004048 49.81328335986767,24.017811281650346 49.813259459853185,24.017831068301593 49.81323455895953,24.01784960929001 49.81320871717513,24.017866859948736 49.81318199675511,24.017882778719418 49.8131544620713,24.017897327252346 49.81312617945717,24.01791047049883 49.81309721704802,24.01792217679564 49.81306764461681,24.017932417941278 49.81303753340613,24.017941169263928 49.813006955956524,24.017948409680887 49.81297598593175,24.017954121749355 49.812944697941305,24.017958291708464 49.8129131673607,24.017960909512414 49.812881470149854,24.017961968854685 49.81284968267015,24.01796146718323 49.812817881500386,24.01795940570662 49.812786143252374,24.01795578939113 49.812754544386344,24.017950626948785 49.81272316102672,24.017943930816358 49.81269206877876,24.017935717125418 49.81266134254643,24.017926005663465 49.81263105635189,24.017914819826267 49.812601283157264,24.01790218656148 49.81257209468876,24.017888136303746 49.81254356126398,24.01787270290137 49.81251575162242,24.017855923534768 49.81248873275995,24.017837838626903 49.81246256976739,24.017818491745903 49.81243732567366,24.017797929500098 49.81241306129401,24.017776201425743 49.81238983508345,24.017753359867665 49.81236770299595,24.017729459853186 49.81234671834965,24.01770455895953 49.8123269316984,24.01767871717513 49.81230839070999,24.017651996755113 49.812291140051265,24.017624462071304 49.81227522128058,24.017596179457176 49.81226067274765,24.017567217048015 49.812247529501164,24.01753764461681 49.81223582320436,24.017507533406132 49.81222558205872,24.01747695595653 49.81221683073607,24.01744598593175 49.812209590319114,24.017414697941305 49.81220387825064,24.017383167360695 49.81219970829153,24.01735147014986 49.81219709048759,24.01731968267015 49.81219603114531))"}]],"stops":{"0":{"passengerId":4,"orderId":1577,"type":1,"length":1000},"1":{"passengerId":5,"orderId":1578,"type":1,"length":1000},"2":{"passengerId":1,"orderId":1575,"type":1,"length":1000},"3":{"passengerId":5,"orderId":1578,"type":2,"length":1000},"4":{"passengerId":2,"orderId":1576,"type":1,"length":1000},"5":{"passengerId":1,"orderId":1575,"type":2,"length":1000},"6":{"passengerId":4,"orderId":1577,"type":2,"length":1000},"7":{"passengerId":2,"orderId":1576,"type":2,"length":1000}},"stateId":1,"price":0}],"state":"success"}'


def get_json():
    url = 'http://188.40.133.134:8480/GatherCarBackend/GCServlet'
    payload = {"action":"get_potential_routes", "weight": 8, "include_polygons": "true"}
    headers = {'Accept-Encoding': 's'}
    response = requests.post(url, data=json.dumps(payload), headers=headers)
    output = json.loads(text)
    # cnt = len(output['list'])
    # for i in range(cnt):
    #     return output['list'][0]
    return output['list']


def get_routes_cnt():
    json = get_json()
    cnt = len(json)
    return cnt

def test():
    route = get_route_by_pos(0)
    return route['stops']

def get_route_by_pos(pos):
    route = get_json()[pos]
    return route


def get_coord_by_order_id(order_id, route_pos, start=True):
    passenger = 0
    route_info = {}
    # for i in range(get_routes_cnt()):
    route = get_route_by_pos(route_pos)
    for order in range(len(route['stops'])):
        id = str(order)
        if order_id == route['stops'][id]['orderId']:
            passengerId = route['stops'][id]['passengerId']
            passenger = passengerId
    # for i in range(get_routes_cnt()):
    route = get_route_by_pos(route_pos)
    for order in range(len(route['passengerOrderHashMap'])):
        if route['passengerOrderHashMap'][order][0]['id'] == passenger:
            order_amount = get_amount_orders(route)
            passenger_amount = get_amount_passengers(route)
            order_ids = get_order_ids(route)
            route_polygons = get_polygons(route)
            if start:
                lng = route['passengerOrderHashMap'][order][1]['depLocation']['mLongitudeE6']
                lat = route['passengerOrderHashMap'][order][1]['depLocation']['mLatitudeE6']
                route_info.update({"lat": float(str(lat)[:2]+"."+str(lat)[2:]), "lng": float(str(lng)[:2]+"."+str(lng)[2:]), "description": (order_id, 'Get On'), "label": 'S', "amount_orders": order_amount,
                                   "passenger_amount": passenger_amount, "list_orders_id": order_ids, "polygons": route_polygons})
            else:
                lng = route['passengerOrderHashMap'][order][1]['destLocation']['mLongitudeE6']
                lat = route['passengerOrderHashMap'][order][1]['destLocation']['mLatitudeE6']
                route_info.update({"lat": float(str(lat)[:2]+"."+str(lat)[2:]), "lng": float(str(lng)[:2]+"."+str(lng)[2:]), "description": (order_id, 'Get Out'), "label": 'F', "amount_orders": order_amount,
                                   "passenger_amount": passenger_amount, "list_orders_id": order_ids, "polygons": route_polygons})
    return route_info


def get_amount_orders(route):
    amount = (len(route['passengerOrderHashMap']))
    return amount


def get_polygons(route):
    polygons = []
    for order in range(len(route['passengerOrderHashMap'])):
        polygon = []
        poly = route['passengerOrderHashMap'][order][1]['polygon']
        poly = poly.split('((')[1].split('))')[0].split(',')
        for i in range(len(poly)):
            lng = float(poly[i].split(' ')[0])
            lat  = float(poly[i].split(' ')[1])
            coord = {"lat": lat, "lng": lng}
            polygon.append(coord)
        polygons.append(polygon)
    return polygons


def get_amount_passengers(route):
    amount_passengers = 0
    for order in range(len(route['passengerOrderHashMap'])):
        amount_passengers += route['passengerOrderHashMap'][order][1]['totalSeats']
    return amount_passengers


def get_order_ids(route):
    ids = []
    for order in range(len(route['passengerOrderHashMap'])):
        ids.append(route['passengerOrderHashMap'][order][1]['id'])
    return ids


def get_cord_of_all_routes():
    routes = []
    for i in range(get_routes_cnt()):
        route = get_route_by_pos(i)
        coor_one_route = []
        for order in range(len(route['stops'])):
            id = str(order)
            type = route['stops'][id]['type']
            order_id = route['stops'][id]['orderId']
            if type == 1:
                cor = get_coord_by_order_id(order_id, i, start=True)
                coor_one_route.append(cor)
            else:
                cor = get_coord_by_order_id(order_id, i, start=False)
                coor_one_route.append(cor)
        routes.append(coor_one_route)
    return routes

def search_form(request):
    return render(request, 'search_form.html')


def google_maps(request):
    routes = get_cord_of_all_routes()
    json_for_js = json.dumps(get_cord_of_all_routes())
    output = json.dumps("1321")
    if request.method == 'POST':
        form = ContactForm(request.POST)
        lat_from = form['lat_from'].value()
        lon_from = form['lon_from'].value()
        lat_to = form['lat_to'].value()
        lon_to = form['lon_to'].value()
        id = form['people'].value()
        data = form['data'].value()
        time = form['time'].value()
        json_send = {
            "action": "set_order",
            "order": {
                "timestamp": 1437140367921,
                "depAddress": "Киев, Приборный переулок, 10",
                "depLocation": {
                    "mAltitude":0,
                    "mLatitudeE6":lat_from,
                    "mLongitudeE6":lon_from},
                "destAddress":"Киев, переулок Раисы Букиной, 3",
                "destLocation":{
                    "mAltitude":0,
                    "mLatitudeE6":lat_to,
                    "mLongitudeE6":lon_to},
                "id": 5,
                "stateId":0,
                "clientType":1,
                "totalSeats":2},
            "user":{
                "email":"azhovnuvhome@gmail.com",
                "gPlusProfile":{
                    "id":"106646917423760946921",
                    "imgUrl":"https://lh3.googleusercontent.com/-RAgLglo1zEg/AAAAAAAAAAI/AAAAAAAACB4/tObTcEGkReE/photo.jpg?sz\u003d50",
                    "link":"https://plus.google.com/+AlexanderZhovnuvaty",
                    "type":1},
                "surName":"Zhovnuvaty",
                "name":"Alexander",
                "role":2,
                "id": id,
                "gender":1}}
        url = 'http://188.40.133.134:8480/GatherCarBackend/GCServlet'
        headers = {'Accept-Encoding': 's'}
        response = requests.post(url, data=json.dumps(json_send), headers=headers)
        output = json.loads(response.text)
    form = ContactForm
    return render(request, 'google_maps.html', {'test': output, 'json': json_for_js, 'routes': routes, 'form': form})

def search(request):
    errors = []
    if 'q' in request.GET:
        q = request.GET['q']
        if not q:
            errors.append('Enter a search term.')
        elif len(q) > 20:
            errors.append('Please enter at most 20 characters.')
        else:
            books = Book.objects.filter(title__icontains=q)
            return render(request, 'search_results.html',
                {'books': books, 'query': q})
    return render(request, 'search_form.html',
        {'errors': errors})


# def contact(request):
#     # if request.method == 'POST':
#     #     form = ContactForm(request.POST)
#     #     if form.is_valid():
#     #         cd = form.cleaned_data
#     #         send_mail(
#     #             cd['subject'],
#     #             cd['message'],
#     #             cd.get('email', 'noreply@example.com'),
#     #             ['siteowner@example.com'],
#     #         )
#     #         return HttpResponseRedirect('/contact/thanks/')
#     # else:
#     #     form = ContactForm(
#     #         initial={'subject': 'I love your site!'}
#     #     )
#     form = get_cord_of_all_routes()
#     points = json.dumps(get_cord_of_all_routes())
#     return render(request, 'google_maps.html', {'json': form})

